<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd"
                   logicalFilePath="202507101200-PRD-initial-schema.xml">

    <changeSet id="202507101200-PRD-initial-schema-1" author="jordi.jaspers">
        <comment>Creating pet_types table for storing types of pets (e.g. Cat, Dog, Lizard).</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS pet_types (
                id   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                name VARCHAR(255) NOT NULL
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-2" author="jordi.jaspers">
        <comment>Creating specialties table for veterinary specialties (e.g. Radiology, Surgery).</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS specialties (
                id   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                name VARCHAR(255) NOT NULL
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-3" author="jordi.jaspers">
        <comment>Creating owners table for pet owners.</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS owners (
                id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                first_name VARCHAR(255) NOT NULL,
                last_name  VARCHAR(255) NOT NULL,
                address    VARCHAR(255),
                city       VARCHAR(255),
                telephone  VARCHAR(255)
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-4" author="jordi.jaspers">
        <comment>Creating vets table for veterinarians.</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS vets (
                id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                first_name VARCHAR(255) NOT NULL,
                last_name  VARCHAR(255) NOT NULL
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-5" author="jordi.jaspers">
        <comment>Creating vet_specialties junction table for many-to-many relationship between vets and specialties.</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS vet_specialties (
                vet_id       INTEGER NOT NULL,
                specialty_id INTEGER NOT NULL,
                PRIMARY KEY (vet_id, specialty_id),
                FOREIGN KEY (vet_id) REFERENCES vets (id) ON DELETE CASCADE,
                FOREIGN KEY (specialty_id) REFERENCES specialties (id) ON DELETE CASCADE
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-6" author="jordi.jaspers">
        <comment>Creating pets table for pets belonging to owners.</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS pets (
                id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                name       VARCHAR(255) NOT NULL,
                birth_date DATE         NOT NULL,
                type_id    INTEGER      NOT NULL,
                owner_id   INTEGER      NOT NULL,
                FOREIGN KEY (type_id) REFERENCES pet_types (id),
                FOREIGN KEY (owner_id) REFERENCES owners (id)
            );
        </sql>
    </changeSet>

    <changeSet id="202507101200-PRD-initial-schema-7" author="jordi.jaspers">
        <comment>Creating visits table for veterinary visits.</comment>
        <sql>
            CREATE TABLE IF NOT EXISTS visits (
                id          INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                pet_id      INTEGER      NOT NULL,
                date        DATE         NOT NULL,
                description VARCHAR(255),
                FOREIGN KEY (pet_id) REFERENCES pets (id)
            );
        </sql>
    </changeSet>

</databaseChangeLog>
