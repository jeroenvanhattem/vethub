<?xml version="1.0" encoding="UTF-8"?>
<configuration scan="false">
    <!-- Human-readable encoder with some nice management-proof colours, default in local development mode -->
    <appender name="HUMANREADABLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <pattern>
                %d{HH:mm:ss.SSS} %highlight(%level) [%green(TX:%X{tx_id})/%yellow(TRACE:%X{traceId})] [%magenta(T:%thread)] [%cyan(L:%logger:%line)]:\n%msg%n\n
            </pattern>
        </encoder>
    </appender>

    <!-- Logstash encoder outputting in JSON, default in container mode -->
    <appender name="LOGSTASHENCODER" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="net.logstash.logback.encoder.LogstashEncoder" />
    </appender>

    <!-- Logging levels -->
    <logger name="org.keycloak" level="DEBUG"/>
    <logger name="com.zaxxer" level="INFO"/>
    <logger name="javax.net.ssl" level="INFO"/>
    <logger name="org.hibernate.sql" level="INFO"/>
    <logger name="org.hibernate.orm.connections.pooling" level="ERROR"/>

    <logger name="org.springframework" level="INFO"/>
    <logger name="org.springframework.web" level="INFO"/>
    <logger name="org.springframework.security" level="INFO"/>
    <logger name="org.springframework.security.access.intercept" level="INFO"/>
    <logger name="org.springframework.context.support" level="ERROR"/>
    <logger name="org.springframework.beans" level="INFO"/>
    <logger name="org.springframework.web.socket" level="INFO"/>
    <logger name="org.springframework.web.socket.handler" level="INFO"/>
    <logger name="org.springframework.data.repository.config" level="WARN"/>
    <logger name="org.springframework.security.web.FilterChainProxy" level="INFO"/>

    <logger name="io.github.jframe.logging.filter" level="INFO"/>
    <logger name="io.github.jframe.logging.voter.MediaTypeVoter" level="ERROR"/>

    <logger name="io.github.jframe" level="${APPLICATION_LOG_LEVEL:-DEBUG}"/>
    <logger name="io.github.eventify" level="${APPLICATION_LOG_LEVEL:-DEBUG}"/>
    <logger name="net.ttddyy.dsproxy.listener" level="${SQL_LOG_LEVEL:-INFO}"/>

    <!-- Root level and appender selection, defaults to HUMANREADABLE, overridable with env var $LOG_APPENDER -->
    <root level="${ROOT_LOG_LEVEL:-INFO}">
        <!-- In the logback config file, the separator between variable and default value is ":-". Deal with it. -->
        <appender-ref ref="${LOG_APPENDER:-HUMANREADABLE}"/>
    </root>
</configuration>
